---
/**
 * OWNER: DYNAMIC (Dev B)
 * Category Filter Sidebar Component
 */
import type { WPCategory } from "../../types/wp";

interface Props {
    categories: WPCategory[];
    currentCategory?: string | null;
}

const { categories, currentCategory } = Astro.props;
---

<div class="bg-white rounded-2xl shadow-card p-6 sticky top-24">
    <h3 class="text-lg font-bold font-heading text-gray-900 mb-4 flex items-center gap-2">
        <svg class="w-5 h-5 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"
            ></path>
        </svg>
        Filter Kategori
    </h3>

    <ul class="space-y-2">
        <li>
            <a href="/artikel" class:list={["flex items-center justify-between px-3 py-2 rounded-lg text-sm font-medium transition-colors", !currentCategory ? "bg-primary text-white" : "text-slate-600 hover:bg-slate-100"]}>
                <span>Semua Artikel</span>
                <span class="text-xs opacity-70">
                    {categories.reduce((sum, c) => sum + c.count, 0)}
                </span>
            </a>
        </li>
        {
            categories.map((category) => (
                <li>
                    <a
                        href={`/artikel/kategori/${category.slug}`}
                        class:list={["flex items-center justify-between px-3 py-2 rounded-lg text-sm font-medium transition-colors", currentCategory === category.slug ? "bg-primary text-white" : "text-slate-600 hover:bg-slate-100"]}
                    >
                        <span>{category.name}</span>
                        <span class="text-xs bg-slate-100 text-slate-500 px-2 py-0.5 rounded-full">{category.count}</span>
                    </a>
                </li>
            ))
        }
    </ul>

    <!-- Search in sidebar -->
    <div class="mt-6 pt-6 border-t border-slate-100">
        <h4 class="text-sm font-semibold text-gray-700 mb-3">Cari Artikel</h4>
        <div class="relative">
            <input
                type="search"
                placeholder="Ketik untuk mencari..."
                id="sidebar-search"
                class="w-full pl-9 pr-3 py-2.5 text-sm border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"
            />
            <svg class="w-4 h-4 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
        </div>
    </div>
</div>

<script>
    const searchInput = document.getElementById("sidebar-search") as HTMLInputElement;
    if (searchInput) {
        searchInput.addEventListener("keydown", (e) => {
            if (e.key === "Enter" && searchInput.value.trim()) {
                window.location.href = `/artikel?search=${encodeURIComponent(searchInput.value.trim())}`;
            }
        });
    }
</script>

