---
import { getScholarships } from "../../../lib/api/endpoints";
import type { WPScholarship } from "../../../types/wp";

let scholarships: WPScholarship[] = [];
try {
    const response = await getScholarships(1, 4); // Fetch 4 items
    scholarships = response.scholarships;
} catch (e) {
    console.warn("Failed to fetch scholarships:", e);
    // Fallback data
    scholarships = [
        {
            id: 1,
            slug: "lpdp-2026",
            title: "Beasiswa LPDP 2026",
            excerpt: "Beasiswa penuh untuk S2 dan S3 ke luar negeri dari Pemerintah Indonesia.",
            country: "Berbagai Negara",
            degree: "S2, S3",
            deadline: "2026-04-30",
            type: "Full Scholarship",
            featuredImage: { src: "https://placehold.co/400x250/145DA0/white?text=LPDP", alt: "LPDP" },
        } as WPScholarship,
        {
            id: 2,
            slug: "chevening-2026",
            title: "Chevening Scholarship UK 2026",
            excerpt: "Beasiswa penuh dari pemerintah Inggris untuk program master.",
            country: "United Kingdom",
            degree: "S2",
            deadline: "2026-11-01",
            type: "Full Scholarship",
            featuredImage: { src: "https://placehold.co/400x250/7c3aed/white?text=Chevening", alt: "Chevening" },
        } as WPScholarship,
    ];
}
---

<section class="py-20 bg-white">
    <div class="container mx-auto px-6">
        <div class="text-center mb-16">
            <span class="inline-block py-1 px-3 rounded-full bg-blue-50 text-ultimate-blue text-base font-bold uppercase tracking-wider mb-4 border border-blue-100"> Scholarship </span>
            <h2 class="text-3xl md:text-4xl font-bold font-heading text-ultimate-navy mb-4">Temukan Beasiswa Terbaik</h2>
            <p class="text-gray-600 text-lg max-w-2xl mx-auto">Info beasiswa terbaru untuk kuliah ke luar negeri</p>
        </div>

        <div class="grid grid-cols-2 md:grid-cols-2 gap-4 md:gap-8 mb-12">
            {
                scholarships.slice(0, 2).map((s) => (
                    <a href={`/beasiswa/${s.slug}`} class="group flex flex-col md:flex-row bg-white rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl hover:-translate-y-1 transition-all border border-slate-100">
                        <div class="w-full md:w-2/5 h-48 md:h-auto overflow-hidden relative">
                            <img
                                src={s.featuredImage?.src || "https://placehold.co/400x250/145DA0/white?text=Beasiswa"}
                                alt={s.title}
                                class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500"
                                loading="lazy"
                            />
                            <div class="absolute top-4 left-4 bg-white/90 backdrop-blur-sm text-ultimate-blue text-base font-bold px-3 py-1 rounded-full uppercase tracking-wider">{s.type}</div>
                        </div>
                        <div class="p-6 md:p-8 flex flex-col justify-center w-full md:w-3/5">
                            <h3 class="text-xl font-bold text-ultimate-navy mb-3 group-hover:text-ultimate-blue transition-colors line-clamp-2">{s.title}</h3>
                            <div class="flex flex-wrap gap-4 text-base text-gray-500 mb-4">
                                {s.country && (
                                    <div class="flex items-center gap-1">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-ultimate-yellow" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                stroke-width="2"
                                                d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                                            />
                                        </svg>
                                        {s.country}
                                    </div>
                                )}
                                {s.degree && (
                                    <div class="flex items-center gap-1">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-ultimate-yellow" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5z" />
                                            <path
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                stroke-width="2"
                                                d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"
                                            />
                                        </svg>
                                        {s.degree}
                                    </div>
                                )}
                            </div>
                            {s.deadline && (
                                <div class="mt-auto text-base font-medium text-red-500 flex items-center gap-1">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                    Deadline: {new Date(s.deadline).toLocaleDateString("id-ID", { day: "numeric", month: "long", year: "numeric" })}
                                </div>
                            )}
                        </div>
                    </a>
                ))
            }
        </div>

        <div class="text-center">
            <a href="/beasiswa" class="inline-flex items-center gap-2 px-8 py-3 border-2 border-ultimate-blue text-ultimate-blue font-bold rounded-xl hover:bg-ultimate-blue hover:text-white transition-all duration-300">
                Lihat Beasiswa Lainnya
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                </svg>
            </a>
        </div>
    </div>
</section>
